<!DOCTYPE html>
<html>
<head>
    <title>Stock Parameters</title>
    <style>
        body {
            background: #00ff00; /* Green screen */
            margin: 0;
            padding: 15px;
            font-family: 'Courier New', monospace;
            color: #ffffff; /* White text */
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .title {
            font-size: 2em;
            color: #ffffff; /* White */
            text-shadow: 2px 2px 0 #333333; /* Dark gray shadow */
            margin: 0;
        }
        
        .subtitle {
            color: #aaaaaa; /* Light gray */
            margin-top: 5px;
        }
        
        .param-list {
            max-width: 1200px;
            margin: 0 auto;
            background: #333333; /* Dark gray */
            border-radius: 8px;
            padding: 15px;
            border: 2px solid #aaaaaa; /* Light gray border */
        }
        
        .param-item {
            padding: 5px 0;
            border-bottom: 1px solid #666666; /* Medium gray */
            font-size: 1.1em;
        }
        
        .stock-name {
            font-weight: bold;
            color: #ffffff; /* White bold */
        }
        
        .param-name {
            color: #aaaaaa; /* Light gray */
        }
    </style>
</head>
<body>
    <div class="header">
        <h1 class="title">⚙️ STOCK CONTROLS</h1>
        <div class="subtitle">Stock to Parameter Mapping</div>
    </div>
    
    <div class="param-list" id="paramList">
        <!-- STOCK:PARAMETER list will be inserted here -->
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let stocks = {};
        
        socket.on('initial_state', (data) => {
            stocks = data.stocks;
            renderParamList();
        });
        
        socket.on('market_update', (data) => {
            if (stocks[data.symbol]) {
                stocks[data.symbol].price = data.price;
                stocks[data.symbol].topHolder = data.topHolder;
                renderParamList();
            }
        });
        
        function renderParamList() {
            const list = document.getElementById('paramList');
            const sortedStocks = Object.entries(stocks)
                .sort(([,a], [,b]) => b.price - a.price)
                .map(([symbol, data]) => ({ symbol, ...data }));
            
            list.innerHTML = sortedStocks.map(stock => `
                <div class="param-item">
                    <span class="stock-name">${stock.symbol}</span>: ${stock.param}
                </div>
            `).join('');
        }
        
        // Auto-refresh every 5 seconds
        setInterval(() => {
            fetch('/api/stocks')
                .then(r => r.json())
                .then(data => {
                    stocks = data.reduce((acc, stock) => {
                        acc[stock.symbol] = stock;
                        return acc;
                    }, {});
                    renderParamList();
                });
        }, 5000);
    </script>
</body>
</html>